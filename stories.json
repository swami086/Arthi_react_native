[{"id": "US-BE-001", "title": "[US-BE-001] Therapist Registration", "description": "Therapist Registration\n**As a** therapist  \n**I want to** register with email/phone and create a secure account  \n**So that** I can access the platform and manage my practice\n\n**Acceptance Criteria:**\n- Supabase Auth configured with email/phone providers\n- `therapists` table created with fields: `id`, `email`, `phone`, `name`, `license_number`, `specialization`, `created_at`\n- Email verification flow implemented\n- Password strength validation (min 8 chars, special chars)\n- RLS policy: therapists can only read/update their own record\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-002", "title": "[US-BE-002] Role-Based Access Control (RBAC)", "description": "Role-Based Access Control (RBAC)\n**As a** system administrator  \n**I want to** define roles (therapist, admin, group_owner, eap_manager)  \n**So that** users have appropriate permissions based on their role\n\n**Acceptance Criteria:**\n- `roles` table created with predefined roles\n- `user_roles` junction table linking users to roles\n- RLS policies enforce role-based data access\n- Group owners can view therapists in their practice\n- EAP managers can view aggregated data (no PHI)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-003", "title": "[US-BE-003] Multi-Factor Authentication (MFA)", "description": "Multi-Factor Authentication (MFA)\n**As a** therapist  \n**I want to** enable MFA via SMS/authenticator app  \n**So that** my account and patient data remain secure\n\n**Acceptance Criteria:**\n- Supabase Auth MFA enabled\n- SMS OTP integration via Twilio/MSG91\n- TOTP support for authenticator apps\n- MFA enrollment flow in user settings\n- Audit log for MFA events\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 2. Practice & Patient Management (Phase 1 - MVP)", "priority": 3}, {"id": "US-BE-004", "title": "[US-BE-004] Patient Profile Creation", "description": "Patient Profile Creation\n**As a** therapist  \n**I want to** create and store patient profiles securely  \n**So that** I can maintain longitudinal patient records\n\n**Acceptance Criteria:**\n- `patients` table with fields: `id`, `therapist_id`, `name`, `age`, `gender`, `contact`, `medical_history`, `created_at`\n- RLS policy: therapists can only access their own patients\n- Encrypted storage for sensitive fields (medical_history)\n- Unique constraint on `therapist_id + contact` to prevent duplicates\n- Soft delete support (retain data for compliance)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-005", "title": "[US-BE-005] Appointment Scheduling", "description": "Appointment Scheduling\n**As a** therapist  \n**I want to** create, update, and cancel appointments  \n**So that** I can manage my calendar efficiently\n\n**Acceptance Criteria:**\n- `appointments` table with fields: `id`, `therapist_id`, `patient_id`, `scheduled_at`, `duration`, `status`, `notes`\n- Status enum: `scheduled`, `completed`, `cancelled`, `no_show`\n- RLS policy: therapists can manage their own appointments\n- Conflict detection (no overlapping appointments)\n- Timezone support (IST default)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-006", "title": "[US-BE-006] Group Practice Management", "description": "Group Practice Management\n**As a** group practice owner  \n**I want to** add therapists to my practice and view their schedules  \n**So that** I can coordinate resources and ensure compliance\n\n**Acceptance Criteria:**\n- `practices` table with fields: `id`, `name`, `owner_id`, `created_at`\n- `practice_therapists` junction table\n- RLS policy: owners can view therapists in their practice\n- Owners can view aggregated appointment stats (not session notes)\n- Invitation flow for adding therapists\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 3. Session Recording & Transcription (Phase 1 - MVP)", "priority": 3}, {"id": "US-BE-007", "title": "[US-BE-007] Audio Upload to Supabase Storage", "description": "Audio Upload to Supabase Storage\n**As a** therapist  \n**I want to** upload session audio recordings securely  \n**So that** they can be transcribed by the AI Scribe Agent\n\n**Acceptance Criteria:**\n- Supabase Storage bucket `session-recordings` created\n- RLS policy: therapists can upload/access only their recordings\n- File size limit: 500MB per recording\n- Supported formats: `.mp3`, `.wav`, `.m4a`\n- Metadata stored in `session_recordings` table: `id`, `session_id`, `file_path`, `duration`, `uploaded_at`\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-008", "title": "[US-BE-008] Scribe Agent - Audio Transcription", "description": "Scribe Agent - Audio Transcription\n**As a** therapist  \n**I want** session audio transcribed to text using OpenAI Whisper  \n**So that** I can review and edit the transcript\n\n**Acceptance Criteria:**\n- Supabase Edge Function `transcribe-audio` created\n- Integrates OpenAI Whisper API with Hinglish language support\n- Stores transcript in `session_transcripts` table: `id`, `session_id`, `transcript_text`, `language`, `created_at`\n- Handles speaker diarization (therapist vs. patient)\n- Error handling for API failures (retry logic)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-009", "title": "[US-BE-009] Scribe Agent - SOAP Note Generation", "description": "Scribe Agent - SOAP Note Generation\n**As a** therapist  \n**I want** AI to generate structured SOAP notes from transcripts  \n**So that** I can save time on documentation\n\n**Acceptance Criteria:**\n- Supabase Edge Function `generate-soap-note` created\n- Uses GPT-4o with custom system prompt (from PRD)\n- Generates SOAP format: Subjective, Objective, Assessment, Plan\n- Includes ICD-10 code suggestions\n- Flags self-harm mentions with RED ALERT\n- Stores draft in `clinical_notes` table: `id`, `session_id`, `note_type`, `content`, `status`, `created_at`\n- Status enum: `draft`, `approved`, `archived`\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-010", "title": "[US-BE-010] Human-in-the-Loop (HITL) Approval", "description": "Human-in-the-Loop (HITL) Approval\n**As a** therapist  \n**I want to** review, edit, and approve AI-generated notes  \n**So that** I maintain clinical responsibility and accuracy\n\n**Acceptance Criteria:**\n- `clinical_notes` table has `approved_by`, `approved_at` fields\n- RLS policy: only note owner can approve\n- Audit trail: stores original AI draft + therapist edits\n- Links to source transcript for verification\n- Cannot delete approved notes (compliance)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---\n\n### 4. Billing & Payments (Phase 1 - MVP)", "priority": 2}, {"id": "US-BE-011", "title": "[US-BE-011] UPI Payment Link Generation", "description": "UPI Payment Link Generation\n**As a** therapist  \n**I want to** generate UPI payment links after sessions  \n**So that** patients can pay conveniently\n\n**Acceptance Criteria:**\n- Integration with Razorpay/Cashfree Payment Gateway\n- Supabase Edge Function `create-payment-link` created\n- `payments` table: `id`, `session_id`, `amount`, `currency`, `status`, `payment_link`, `created_at`\n- Status enum: `pending`, `completed`, `failed`, `refunded`\n- Webhook handler for payment confirmation\n- RLS policy: therapists can view their own payments\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-012", "title": "[US-BE-012] Subscription Management", "description": "Subscription Management\n**As a** therapist  \n**I want to** subscribe to Free/Pro/BioSync tiers  \n**So that** I can access features based on my plan\n\n**Acceptance Criteria:**\n- `subscriptions` table: `id`, `therapist_id`, `plan`, `status`, `start_date`, `end_date`\n- Plan enum: `free`, `pro`, `biosync`\n- Pricing: Free (\u20b90), Pro (\u20b9999/mo), BioSync (\u20b91999/mo)\n- Razorpay subscription API integration\n- Webhook handler for subscription events (created, renewed, cancelled)\n- Feature gating based on plan (e.g., AI Scribe limited to 10 sessions/month on Free)\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 5. WhatsApp Integration (Phase 2 - BioSync)", "priority": 3}, {"id": "US-BE-013", "title": "[US-BE-013] WhatsApp Business API Setup", "description": "WhatsApp Business API Setup\n**As a** system administrator  \n**I want to** integrate WhatsApp Business API  \n**So that** therapists can communicate with patients via WhatsApp\n\n**Acceptance Criteria:**\n- WhatsApp Business API account created (via 360Dialog/Twilio)\n- Webhook endpoint in Supabase Edge Function for incoming messages\n- `whatsapp_messages` table: `id`, `therapist_id`, `patient_id`, `message_text`, `direction`, `timestamp`\n- Direction enum: `inbound`, `outbound`\n- Template messages approved by WhatsApp (appointment reminders, payment links)\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-014", "title": "[US-BE-014] Growth Agent - WhatsApp Triage Bot", "description": "Growth Agent - WhatsApp Triage Bot\n**As a** potential patient  \n**I want to** inquire about therapy services via WhatsApp  \n**So that** I can get quick responses and book appointments\n\n**Acceptance Criteria:**\n- Supabase Edge Function `whatsapp-triage-bot` created\n- Uses GPT-4o-mini for cost-effective responses\n- Handles FAQs: pricing, availability, specializations\n- Captures lead information: name, concern, preferred time\n- Creates entry in `leads` table: `id`, `therapist_id`, `name`, `contact`, `source`, `status`, `created_at`\n- Escalates complex queries to therapist\n\n**Phase:** 2 (BioSync)  \n**Priority:** Medium\n\n---", "priority": 3}, {"id": "US-BE-015", "title": "[US-BE-015] Automated Appointment Reminders", "description": "Automated Appointment Reminders\n**As a** therapist  \n**I want** patients to receive WhatsApp reminders 24 hours before appointments  \n**So that** no-show rates decrease\n\n**Acceptance Criteria:**\n- Supabase cron job (via pg_cron extension) runs daily\n- Identifies appointments in next 24 hours\n- Sends WhatsApp template message via API\n- Logs reminder in `whatsapp_messages` table\n- Handles opt-out requests (stores in `patient_preferences`)\n\n**Phase:** 2 (BioSync)  \n**Priority:** Medium\n\n---\n\n### 6. BioSync - Wearable Integration (Phase 2)", "priority": 3}, {"id": "US-BE-016", "title": "[US-BE-016] Google Health Connect Integration", "description": "Google Health Connect Integration\n**As a** patient  \n**I want to** connect my wearable device (Noise/Boat) to share health data  \n**So that** my therapist can monitor my well-being between sessions\n\n**Acceptance Criteria:**\n- Supabase Edge Function `sync-health-data` created\n- Integrates Google Health Connect API\n- Fetches data types: HRV, sleep duration, activity minutes, heart rate\n- Stores in `wearable_data` table: `id`, `patient_id`, `data_type`, `value`, `recorded_at`, `synced_at`\n- OAuth 2.0 flow for patient consent\n- Data retention: 90 days (configurable)\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-017", "title": "[US-BE-017] BioSync Agent - Pre-Session Intelligence Brief", "description": "BioSync Agent - Pre-Session Intelligence Brief\n**As a** therapist  \n**I want** AI to analyze patient wearable data before sessions  \n**So that** I can identify concerning trends (e.g., sleep deprivation, HRV drops)\n\n**Acceptance Criteria:**\n- Supabase Edge Function `generate-biosync-brief` created\n- Runs 5 minutes before scheduled appointment\n- Analyzes last 7 days of wearable data\n- Uses GPT-4o to correlate data with patient history\n- Generates brief: \"Alert: Sleep dropped 40% this week. HRV down 15% on Tuesday.\"\n- Stores in `biosync_briefs` table: `id`, `session_id`, `insights`, `created_at`\n- Flags critical alerts (e.g., sustained high heart rate)\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-018", "title": "[US-BE-018] Predictive Analytics - Dropout Risk", "description": "Predictive Analytics - Dropout Risk\n**As a** therapist  \n**I want** AI to predict patient dropout risk based on engagement patterns  \n**So that** I can proactively reach out to at-risk patients\n\n**Acceptance Criteria:**\n- Supabase Edge Function `predict-dropout-risk` created\n- Analyzes: missed appointments, wearable data gaps, message response times\n- Uses GPT-4o for pattern recognition\n- Generates risk score: low, medium, high\n- Stores in `patient_risk_scores` table: `id`, `patient_id`, `risk_level`, `factors`, `calculated_at`\n- Triggers alert to therapist if risk = high\n\n**Phase:** 2 (BioSync)  \n**Priority:** Medium\n\n---\n\n### 7. ABDM Compliance (Phase 3)", "priority": 3}, {"id": "US-BE-019", "title": "[US-BE-019] ABHA ID Creation", "description": "ABHA ID Creation\n**As a** patient  \n**I want to** create an ABHA (Ayushman Bharat Health Account) ID  \n**So that** my health records are linked to India's national health system\n\n**Acceptance Criteria:**\n- Supabase Edge Function `create-abha-id` created\n- Integrates ABDM Sandbox/Production API\n- Captures: Aadhaar number, mobile number, name\n- Generates 14-digit ABHA ID\n- Stores in `abha_records` table: `id`, `patient_id`, `abha_id`, `created_at`\n- Handles OTP verification via ABDM\n\n**Phase:** 3 (ABDM)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-020", "title": "[US-BE-020] Compliance Agent - Consent Management (HIECM)", "description": "Compliance Agent - Consent Management (HIECM)\n**As a** patient  \n**I want to** grant/revoke consent for sharing my health records  \n**So that** I control who accesses my data\n\n**Acceptance Criteria:**\n- Supabase Edge Function `manage-consent` created\n- Integrates Health Information Exchange Consent Manager (HIECM)\n- Creates consent artifacts per ABDM spec\n- Stores in `consent_records` table: `id`, `patient_id`, `purpose`, `granted_at`, `expires_at`, `revoked_at`\n- Purpose enum: `care_management`, `research`, `insurance`\n- Audit trail for all consent changes\n\n**Phase:** 3 (ABDM)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-021", "title": "[US-BE-021] Mental Health Data Compliance", "description": "Mental Health Data Compliance\n**As a** system administrator  \n**I want** mental health data flagged as sensitive per ABDM guidelines  \n**So that** it requires explicit consent for sharing\n\n**Acceptance Criteria:**\n- `clinical_notes` table has `sensitivity_level` field\n- Enum: `normal`, `sensitive`, `highly_sensitive`\n- Mental health notes auto-tagged as `highly_sensitive`\n- HIECM consent checks before sharing\n- Audit log for all access attempts\n\n**Phase:** 3 (ABDM)  \n**Priority:** High\n\n---\n\n### 8. Analytics & Reporting (Phase 3)", "priority": 2}, {"id": "US-BE-022", "title": "[US-BE-022] Therapist Dashboard Metrics", "description": "Therapist Dashboard Metrics\n**As a** therapist  \n**I want to** view key metrics (sessions completed, revenue, patient adherence)  \n**So that** I can track my practice performance\n\n**Acceptance Criteria:**\n- Supabase Edge Function `get-dashboard-metrics` created\n- Aggregates data from `appointments`, `payments`, `clinical_notes`\n- Returns JSON: `{ sessions_completed, revenue, avg_session_duration, no_show_rate }`\n- RLS policy: therapists see only their own metrics\n- Caching layer (Redis/Supabase cache) for performance\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---", "priority": 3}, {"id": "US-BE-023", "title": "[US-BE-023] EAP Manager - ROI Reporting", "description": "EAP Manager - ROI Reporting\n**As an** EAP manager  \n**I want to** view aggregated outcome data (without PHI)  \n**So that** I can demonstrate ROI to corporate clients\n\n**Acceptance Criteria:**\n- Supabase Edge Function `get-eap-report` created\n- Aggregates: total sessions, avg improvement scores, adherence rates\n- No PHI exposed (only anonymized stats)\n- Filters by date range, therapist, corporate client\n- Exports to PDF/CSV\n\n**Phase:** 3 (ABDM)  \n**Priority:** Medium\n\n---\n\n### 9. Data Security & Privacy (All Phases)", "priority": 3}, {"id": "US-BE-024", "title": "[US-BE-024] Row-Level Security (RLS) Policies", "description": "Row-Level Security (RLS) Policies\n**As a** system administrator  \n**I want** RLS policies enforced on all tables  \n**So that** users can only access their own data\n\n**Acceptance Criteria:**\n- RLS enabled on all tables: `therapists`, `patients`, `appointments`, `clinical_notes`, `payments`, `wearable_data`\n- Policies use `auth.uid()` to filter rows\n- Group owners can view therapists in their practice (via `practice_therapists` join)\n- EAP managers can view aggregated data (via materialized views)\n- Audit: RLS policy violations logged\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-025", "title": "[US-BE-025] Data Encryption at Rest", "description": "Data Encryption at Rest\n**As a** system administrator  \n**I want** sensitive data encrypted at rest  \n**So that** it's protected from unauthorized access\n\n**Acceptance Criteria:**\n- Supabase Storage uses AES-256 encryption\n- Sensitive fields in `patients` table encrypted using `pgcrypto` extension\n- Encryption keys managed via Supabase Vault\n- Decryption only via authorized Edge Functions\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-026", "title": "[US-BE-026] Audit Logging", "description": "Audit Logging\n**As a** compliance officer  \n**I want** all data access logged  \n**So that** I can audit for security breaches\n\n**Acceptance Criteria:**\n- `audit_logs` table: `id`, `user_id`, `action`, `table_name`, `record_id`, `timestamp`\n- Triggers on all tables log: `INSERT`, `UPDATE`, `DELETE`\n- Logs stored for 7 years (ABDM requirement)\n- Immutable (no updates/deletes allowed)\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 10. AI Agent Orchestration (Phase 2)", "priority": 3}, {"id": "US-BE-027", "title": "[US-BE-027] Agent Orchestrator", "description": "Agent Orchestrator\n**As a** system  \n**I want** a central orchestrator to coordinate Scribe, BioSync, Compliance, and Growth agents  \n**So that** workflows execute in the correct sequence\n\n**Acceptance Criteria:**\n- Supabase Edge Function `orchestrate-agents` created\n- Uses state machine pattern (e.g., XState)\n- Workflow example: Session ends \u2192 Transcribe audio \u2192 Generate SOAP note \u2192 Send payment link \u2192 Log to ABDM\n- Handles agent failures gracefully (retry logic, fallback)\n- Logs workflow execution in `agent_workflows` table\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-BE-028", "title": "[US-BE-028] RAG (Retrieval-Augmented Generation) for Clinical Context", "description": "RAG (Retrieval-Augmented Generation) for Clinical Context\n**As a** Scribe Agent  \n**I want** access to patient history and ICD-10 codes  \n**So that** I generate contextually accurate notes\n\n**Acceptance Criteria:**\n- Vector database (Supabase pgvector extension) stores:\n  - Patient historical notes (embeddings)\n  - ICD-10 coding manual (embeddings)\n  - Mental Healthcare Act 2017 guidelines (embeddings)\n- Supabase Edge Function `rag-query` retrieves relevant context\n- GPT-4o uses context in system prompt\n- Embeddings generated via OpenAI `text-embedding-3-small`\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 11. Cost Optimization (All Phases)", "priority": 3}, {"id": "US-BE-029", "title": "[US-BE-029] Prompt Caching for AI Calls", "description": "Prompt Caching for AI Calls\n**As a** system administrator  \n**I want** to cache repeated AI prompts  \n**So that** I reduce OpenAI API costs\n\n**Acceptance Criteria:**\n- Supabase Edge Functions use Redis/Supabase cache\n- Cache key: hash of system prompt + user input\n- TTL: 24 hours\n- Cache hit rate tracked in analytics\n- Estimated savings: 40% on GPT-4o calls\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---", "priority": 3}, {"id": "US-BE-030", "title": "[US-BE-030] Model Selection Based on Task", "description": "Model Selection Based on Task\n**As a** system  \n**I want** to use GPT-4o-mini for routine tasks and GPT-4o for complex reasoning  \n**So that** I optimize cost vs. quality\n\n**Acceptance Criteria:**\n- Routing logic in Edge Functions:\n  - GPT-4o-mini: WhatsApp triage, appointment reminders, FAQs\n  - GPT-4o: SOAP note generation, BioSync analysis, dropout prediction\n- Cost tracking per model in `ai_usage` table\n- Monthly budget alerts\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n## FRONTEND USER STORIES\n\n### 1. Authentication & Onboarding (Phase 1 - MVP)", "priority": 3}, {"id": "US-FE-001", "title": "[US-FE-001] Therapist Registration Flow", "description": "Therapist Registration Flow\n**As a** therapist  \n**I want** a simple registration form  \n**So that** I can quickly create an account\n\n**Acceptance Criteria:**\n- React form with fields: email, phone, password, name, license number\n- Client-side validation (email format, phone format, password strength)\n- Supabase Auth integration (`supabase.auth.signUp()`)\n- Email verification link sent\n- Redirects to onboarding wizard after signup\n- Mobile-responsive design\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-002", "title": "[US-FE-002] Login with MFA", "description": "Login with MFA\n**As a** therapist  \n**I want to** log in with email/phone and MFA  \n**So that** my account is secure\n\n**Acceptance Criteria:**\n- Login form with email/phone + password\n- MFA prompt if enabled (SMS OTP or TOTP)\n- Supabase Auth integration (`supabase.auth.signInWithPassword()`)\n- \"Remember me\" option (session persistence)\n- Error handling: invalid credentials, MFA failure\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-003", "title": "[US-FE-003] Onboarding Wizard", "description": "Onboarding Wizard\n**As a** new therapist  \n**I want** a guided onboarding flow  \n**So that** I can set up my profile and preferences\n\n**Acceptance Criteria:**\n- Multi-step wizard: Profile \u2192 Specialization \u2192 Availability \u2192 Payment Setup\n- Progress indicator (e.g., \"Step 2 of 4\")\n- Saves progress to Supabase (`therapist_profiles` table)\n- Skip option (can complete later)\n- Mobile-first design (mimics WhatsApp UX per PRD)\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 2. Dashboard & Navigation (Phase 1 - MVP)", "priority": 3}, {"id": "US-FE-004", "title": "[US-FE-004] Therapist Dashboard", "description": "Therapist Dashboard\n**As a** therapist  \n**I want** a dashboard showing today's appointments, pending notes, and revenue  \n**So that** I can quickly see my day at a glance\n\n**Acceptance Criteria:**\n- Dashboard widgets:\n  - Today's appointments (list with patient names, times)\n  - Pending SOAP notes (count + link to review)\n  - This month's revenue (\u20b9 amount)\n  - Quick actions: \"Start Session\", \"Add Patient\", \"View Calendar\"\n- Real-time updates via Supabase Realtime subscriptions\n- Mobile-responsive (card-based layout)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-005", "title": "[US-FE-005] Mobile-First Navigation", "description": "Mobile-First Navigation\n**As a** therapist  \n**I want** a bottom navigation bar (like WhatsApp)  \n**So that** I can easily switch between sections on mobile\n\n**Acceptance Criteria:**\n- Bottom nav with icons: Home, Patients, Calendar, Notes, Settings\n- Active tab highlighted\n- Smooth transitions between views\n- Works on iOS and Android browsers\n- Accessible (ARIA labels)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---\n\n### 3. Patient Management (Phase 1 - MVP)", "priority": 2}, {"id": "US-FE-006", "title": "[US-FE-006] Add New Patient", "description": "Add New Patient\n**As a** therapist  \n**I want to** add a new patient with basic details  \n**So that** I can start scheduling sessions\n\n**Acceptance Criteria:**\n- Form fields: name, age, gender, contact (phone/email), medical history\n- Client-side validation (required fields, phone format)\n- Supabase insert into `patients` table\n- Success toast notification\n- Redirects to patient detail page\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-007", "title": "[US-FE-007] Patient List View", "description": "Patient List View\n**As a** therapist  \n**I want to** view all my patients in a searchable list  \n**So that** I can quickly find patient records\n\n**Acceptance Criteria:**\n- Table/list view with columns: name, age, last session date, status\n- Search bar (filters by name)\n- Pagination (20 patients per page)\n- Click row to view patient details\n- Fetches data from Supabase (`patients` table with RLS)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-008", "title": "[US-FE-008] Patient Detail Page", "description": "Patient Detail Page\n**As a** therapist  \n**I want to** view a patient's full profile and session history  \n**So that** I can review their treatment progress\n\n**Acceptance Criteria:**\n- Sections: Profile, Session History, Clinical Notes, Wearable Data (Phase 2)\n- Session history: list of past sessions with dates, notes, payment status\n- Edit profile button\n- \"Schedule Session\" button\n- Fetches data from Supabase (joins `patients`, `appointments`, `clinical_notes`)\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---\n\n### 4. Scheduling (Phase 1 - MVP)", "priority": 2}, {"id": "US-FE-009", "title": "[US-FE-009] Calendar View", "description": "Calendar View\n**As a** therapist  \n**I want** a calendar showing my appointments  \n**So that** I can manage my schedule visually\n\n**Acceptance Criteria:**\n- Calendar component (e.g., FullCalendar.js or React Big Calendar)\n- Views: day, week, month\n- Color-coded appointments: scheduled (blue), completed (green), cancelled (red)\n- Click appointment to view details\n- Drag-and-drop to reschedule (updates Supabase)\n- Syncs with Supabase Realtime for live updates\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-010", "title": "[US-FE-010] Book Appointment", "description": "Book Appointment\n**As a** therapist  \n**I want to** book an appointment for a patient  \n**So that** I can schedule sessions\n\n**Acceptance Criteria:**\n- Modal/form with fields: patient (dropdown), date, time, duration\n- Conflict detection (shows error if slot already booked)\n- Supabase insert into `appointments` table\n- Sends WhatsApp reminder to patient (Phase 2)\n- Success notification\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---\n\n### 5. Session Recording & Notes (Phase 1 - MVP)", "priority": 2}, {"id": "US-FE-011", "title": "[US-FE-011] Start Session Recording", "description": "Start Session Recording\n**As a** therapist  \n**I want to** record session audio from my mobile device  \n**So that** it can be transcribed by AI\n\n**Acceptance Criteria:**\n- \"Record\" button on session detail page\n- Uses browser MediaRecorder API\n- Shows recording timer (e.g., \"00:15:32\")\n- \"Stop\" button to end recording\n- Uploads audio to Supabase Storage (`session-recordings` bucket)\n- Progress bar during upload\n- Error handling: mic permission denied, upload failure\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-012", "title": "[US-FE-012] Review AI-Generated SOAP Note", "description": "Review AI-Generated SOAP Note\n**As a** therapist  \n**I want to** review and edit the AI-generated SOAP note  \n**So that** I can ensure accuracy before approval\n\n**Acceptance Criteria:**\n- Split view: transcript (left) + SOAP note (right)\n- Editable SOAP note (rich text editor)\n- Highlights: RED ALERT for self-harm mentions\n- \"Approve\" button (updates `clinical_notes.status` to `approved`)\n- \"Regenerate\" button (calls Scribe Agent again)\n- Links to source transcript for verification\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-013", "title": "[US-FE-013] Clinical Notes Library", "description": "Clinical Notes Library\n**As a** therapist  \n**I want to** view all my clinical notes in one place  \n**So that** I can search and reference past sessions\n\n**Acceptance Criteria:**\n- List view with filters: patient, date range, note type (SOAP/DAP)\n- Search bar (full-text search on note content)\n- Export to PDF button\n- Click note to view full details\n- Fetches from Supabase (`clinical_notes` table)\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 6. Billing & Payments (Phase 1 - MVP)", "priority": 3}, {"id": "US-FE-014", "title": "[US-FE-014] Generate Payment Link", "description": "Generate Payment Link\n**As a** therapist  \n**I want to** generate a UPI payment link after a session  \n**So that** the patient can pay conveniently\n\n**Acceptance Criteria:**\n- \"Generate Payment Link\" button on session detail page\n- Modal with fields: amount (pre-filled with session fee), notes\n- Calls Supabase Edge Function `create-payment-link`\n- Displays UPI link + QR code\n- \"Send via WhatsApp\" button (Phase 2)\n- Copies link to clipboard\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-015", "title": "[US-FE-015] Payment History", "description": "Payment History\n**As a** therapist  \n**I want to** view all payments received  \n**So that** I can track my revenue\n\n**Acceptance Criteria:**\n- Table view with columns: date, patient, amount, status, payment method\n- Filters: date range, status (pending/completed/failed)\n- Total revenue displayed at top\n- Export to CSV button\n- Fetches from Supabase (`payments` table)\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---", "priority": 3}, {"id": "US-FE-016", "title": "[US-FE-016] Subscription Management", "description": "Subscription Management\n**As a** therapist  \n**I want to** upgrade/downgrade my subscription plan  \n**So that** I can access more features\n\n**Acceptance Criteria:**\n- Pricing page with plans: Free, Pro (\u20b9999/mo), BioSync (\u20b91999/mo)\n- Feature comparison table\n- \"Upgrade\" button (redirects to Razorpay checkout)\n- Current plan badge on dashboard\n- Billing history page\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 7. WhatsApp Integration (Phase 2 - BioSync)", "priority": 3}, {"id": "US-FE-017", "title": "[US-FE-017] WhatsApp Inbox", "description": "WhatsApp Inbox\n**As a** therapist  \n**I want** a WhatsApp-style inbox to chat with patients  \n**So that** I can communicate conveniently\n\n**Acceptance Criteria:**\n- Chat list view (left sidebar): patient names, last message, timestamp\n- Chat window (right): message history, input box, send button\n- Real-time updates via Supabase Realtime\n- Supports text, images, documents\n- Fetches from Supabase (`whatsapp_messages` table)\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-018", "title": "[US-FE-018] Send Appointment Reminder", "description": "Send Appointment Reminder\n**As a** therapist  \n**I want to** manually send a WhatsApp reminder to a patient  \n**So that** they don't miss their appointment\n\n**Acceptance Criteria:**\n- \"Send Reminder\" button on appointment detail page\n- Pre-filled template message (editable)\n- Calls Supabase Edge Function `send-whatsapp-message`\n- Success notification\n- Message logged in `whatsapp_messages` table\n\n**Phase:** 2 (BioSync)  \n**Priority:** Medium\n\n---\n\n### 8. BioSync - Wearable Data (Phase 2)", "priority": 3}, {"id": "US-FE-019", "title": "[US-FE-019] Patient Wearable Connection", "description": "Patient Wearable Connection\n**As a** patient  \n**I want to** connect my wearable device via Google Health Connect  \n**So that** my therapist can monitor my health data\n\n**Acceptance Criteria:**\n- \"Connect Wearable\" button on patient profile page\n- OAuth 2.0 flow (redirects to Google Health Connect)\n- Consent screen: explains data usage, retention policy\n- Success notification after connection\n- Displays connected device name (e.g., \"Noise ColorFit Pro 4\")\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-020", "title": "[US-FE-020] Wearable Data Dashboard", "description": "Wearable Data Dashboard\n**As a** therapist  \n**I want to** view a patient's wearable data trends  \n**So that** I can identify health patterns\n\n**Acceptance Criteria:**\n- Charts: HRV (line chart), sleep duration (bar chart), activity minutes (area chart)\n- Date range selector (last 7 days, 30 days, 90 days)\n- Anomaly highlights (e.g., \"Sleep dropped 40% this week\")\n- Fetches from Supabase (`wearable_data` table)\n- Uses Chart.js or Recharts for visualization\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-021", "title": "[US-FE-021] Pre-Session Intelligence Brief", "description": "Pre-Session Intelligence Brief\n**As a** therapist  \n**I want to** view the BioSync brief before a session  \n**So that** I can prepare for the conversation\n\n**Acceptance Criteria:**\n- Alert banner on dashboard 5 minutes before session\n- Modal with brief: \"Alert: Rahul's HRV dropped 15% on Tuesday. Correlates with reported work stress.\"\n- \"View Full Report\" button (opens detailed wearable dashboard)\n- Fetches from Supabase (`biosync_briefs` table)\n\n**Phase:** 2 (BioSync)  \n**Priority:** High\n\n---\n\n### 9. ABDM Compliance (Phase 3)", "priority": 2}, {"id": "US-FE-022", "title": "[US-FE-022] ABHA ID Creation Flow", "description": "ABHA ID Creation Flow\n**As a** patient  \n**I want to** create an ABHA ID from the app  \n**So that** my health records are linked to India's national system\n\n**Acceptance Criteria:**\n- \"Create ABHA ID\" button on patient profile page\n- Form fields: Aadhaar number, mobile number, name\n- OTP verification step\n- Calls Supabase Edge Function `create-abha-id`\n- Displays generated 14-digit ABHA ID\n- Success notification\n\n**Phase:** 3 (ABDM)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-FE-023", "title": "[US-FE-023] Consent Management UI", "description": "Consent Management UI\n**As a** patient  \n**I want to** grant/revoke consent for sharing my health records  \n**So that** I control who accesses my data\n\n**Acceptance Criteria:**\n- \"Manage Consent\" page with list of consent requests\n- Each request shows: requester name, purpose, expiry date\n- \"Grant\" / \"Revoke\" buttons\n- Calls Supabase Edge Function `manage-consent`\n- Audit trail displayed (who accessed data, when)\n\n**Phase:** 3 (ABDM)  \n**Priority:** High\n\n---\n\n### 10. Analytics & Reporting (Phase 3)", "priority": 2}, {"id": "US-FE-024", "title": "[US-FE-024] Therapist Analytics Dashboard", "description": "Therapist Analytics Dashboard\n**As a** therapist  \n**I want to** view key performance metrics  \n**So that** I can track my practice growth\n\n**Acceptance Criteria:**\n- Widgets: sessions completed (this month), revenue (this month), avg session duration, no-show rate\n- Charts: revenue trend (line chart), sessions by day (bar chart)\n- Date range selector\n- Fetches from Supabase Edge Function `get-dashboard-metrics`\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---", "priority": 3}, {"id": "US-FE-025", "title": "[US-FE-025] EAP Manager ROI Report", "description": "EAP Manager ROI Report\n**As an** EAP manager  \n**I want to** view aggregated outcome data  \n**So that** I can demonstrate ROI to corporate clients\n\n**Acceptance Criteria:**\n- Report page with filters: date range, therapist, corporate client\n- Metrics: total sessions, avg improvement scores, adherence rates\n- Export to PDF/CSV button\n- No PHI displayed (only anonymized stats)\n- Fetches from Supabase Edge Function `get-eap-report`\n\n**Phase:** 3 (ABDM)  \n**Priority:** Medium\n\n---\n\n### 11. Settings & Preferences (All Phases)", "priority": 3}, {"id": "US-FE-026", "title": "[US-FE-026] Profile Settings", "description": "Profile Settings\n**As a** therapist  \n**I want to** update my profile information  \n**So that** patients see accurate details\n\n**Acceptance Criteria:**\n- Form fields: name, email, phone, specialization, bio, profile photo\n- Upload profile photo to Supabase Storage\n- Updates Supabase (`therapists` table)\n- Success notification\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---", "priority": 3}, {"id": "US-FE-027", "title": "[US-FE-027] Notification Preferences", "description": "Notification Preferences\n**As a** therapist  \n**I want to** configure notification preferences  \n**So that** I control how I'm alerted\n\n**Acceptance Criteria:**\n- Toggles: email notifications, WhatsApp notifications, push notifications\n- Notification types: appointment reminders, payment received, new patient inquiry\n- Saves to Supabase (`therapist_preferences` table)\n\n**Phase:** 1 (MVP)  \n**Priority:** Low\n\n---", "priority": 4}, {"id": "US-FE-028", "title": "[US-FE-028] Language Preference (Hinglish Support)", "description": "Language Preference (Hinglish Support)\n**As a** therapist  \n**I want to** set my preferred language (English/Hindi/Hinglish)  \n**So that** the UI and AI responses match my preference\n\n**Acceptance Criteria:**\n- Language selector in settings\n- Options: English, Hindi, Hinglish (code-switching)\n- Updates UI text (i18n library)\n- Passes language preference to AI agents (system prompt)\n\n**Phase:** 1 (MVP)  \n**Priority:** Low\n\n---\n\n### 12. Mobile App (Optional - Future Phase)", "priority": 4}, {"id": "US-FE-029", "title": "[US-FE-029] React Native Mobile App", "description": "React Native Mobile App\n**As a** therapist  \n**I want** a native mobile app (iOS/Android)  \n**So that** I can access TherapyFlow on the go\n\n**Acceptance Criteria:**\n- React Native app with same features as web app\n- Push notifications for appointments, payments\n- Offline mode (syncs when online)\n- Biometric authentication (Face ID, fingerprint)\n- Published on App Store and Google Play\n\n**Phase:** Future  \n**Priority:** Low\n\n---\n\n## CROSS-CUTTING USER STORIES\n\n### 13. Performance & Scalability (All Phases)", "priority": 4}, {"id": "US-XC-001", "title": "[US-XC-001] Page Load Performance", "description": "Page Load Performance\n**As a** user  \n**I want** pages to load in under 2 seconds  \n**So that** the app feels fast and responsive\n\n**Acceptance Criteria:**\n- Lighthouse score: Performance > 90\n- First Contentful Paint (FCP) < 1.5s\n- Time to Interactive (TTI) < 3s\n- Code splitting (lazy load routes)\n- Image optimization (WebP format, lazy loading)\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---", "priority": 3}, {"id": "US-XC-002", "title": "[US-XC-002] Supabase Connection Pooling", "description": "Supabase Connection Pooling\n**As a** system administrator  \n**I want** connection pooling enabled  \n**So that** the app handles high concurrent users\n\n**Acceptance Criteria:**\n- Supabase connection pooler configured (PgBouncer)\n- Max connections: 100 (adjustable)\n- Connection timeout: 30s\n- Monitors connection usage in Supabase dashboard\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 14. Error Handling & Monitoring (All Phases)", "priority": 3}, {"id": "US-XC-003", "title": "[US-XC-003] Error Boundary Component", "description": "Error Boundary Component\n**As a** user  \n**I want** graceful error handling  \n**So that** the app doesn't crash unexpectedly\n\n**Acceptance Criteria:**\n- React Error Boundary wraps all routes\n- Displays user-friendly error message\n- Logs error to Sentry/LogRocket\n- \"Retry\" button to reload component\n\n**Phase:** 1 (MVP)  \n**Priority:** High\n\n---", "priority": 2}, {"id": "US-XC-004", "title": "[US-XC-004] Real-Time Monitoring", "description": "Real-Time Monitoring\n**As a** system administrator  \n**I want** real-time monitoring of app health  \n**So that** I can detect and fix issues quickly\n\n**Acceptance Criteria:**\n- Sentry integration for error tracking\n- Supabase dashboard for database metrics\n- Netlify analytics for frontend performance\n- Alerts: email/Slack for critical errors\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n### 15. Accessibility (All Phases)", "priority": 3}, {"id": "US-XC-005", "title": "[US-XC-005] WCAG 2.1 AA Compliance", "description": "WCAG 2.1 AA Compliance\n**As a** user with disabilities  \n**I want** the app to be accessible  \n**So that** I can use it with assistive technologies\n\n**Acceptance Criteria:**\n- Keyboard navigation (tab order, focus indicators)\n- ARIA labels on all interactive elements\n- Color contrast ratio > 4.5:1\n- Screen reader tested (NVDA, JAWS)\n- Lighthouse Accessibility score > 90\n\n**Phase:** 1 (MVP)  \n**Priority:** Medium\n\n---\n\n## IMPLEMENTATION SEQUENCE\n\n### Phase 1 (MVP) - Weeks 1-12\n**Goal:** Ambient Scribe + Basic Scheduling\n\n**Backend:**\n1. US-BE-001, US-BE-002, US-BE-003 (Authentication)\n2. US-BE-004, US-BE-005, US-BE-006 (Practice Management)\n3. US-BE-007, US-BE-008, US-BE-009, US-BE-010 (Session Recording & Scribe Agent)\n4. US-BE-011, US-BE-012 (Billing & Payments)\n5. US-BE-024, US-BE-025, US-BE-026 (Security)\n6. US-BE-028 (RAG for Clinical Context)\n\n**Frontend:**\n1. US-FE-001, US-FE-002, US-FE-003 (Authentication & Onboarding)\n2. US-FE-004, US-FE-005 (Dashboard & Navigation)\n3. US-FE-006, US-FE-007, US-FE-008 (Patient Management)\n4. US-FE-009, US-FE-010 (Scheduling)\n5. US-FE-011, US-FE-012, US-FE-013 (Session Recording & Notes)\n6. US-FE-014, US-FE-015, US-FE-016 (Billing & Payments)\n\n---\n\n### Phase 2 (BioSync) - Weeks 13-24\n**Goal:** BioSync Integration + WhatsApp Bots\n\n**Backend:**\n1. US-BE-013, US-BE-014, US-BE-015 (WhatsApp Integration)\n2. US-BE-016, US-BE-017, US-BE-018 (BioSync - Wearable Integration)\n3. US-BE-027 (Agent Orchestrator)\n\n**Frontend:**\n1. US-FE-017, US-FE-018 (WhatsApp Inbox)\n2. US-FE-019, US-FE-020, US-FE-021 (Wearable Data Dashboard)\n\n---\n\n### Phase 3 (ABDM) - Weeks 25-36\n**Goal:** ABDM Certification + EAP Partnerships\n\n**Backend:**\n1. US-BE-019, US-BE-020, US-BE-021 (ABDM Compliance)\n2. US-BE-022, US-BE-023 (Analytics & Reporting)\n\n**Frontend:**\n1. US-FE-022, US-FE-023 (ABHA ID & Consent Management)\n2. US-FE-024, US-FE-025 (Analytics Dashboards)\n\n---\n\n## TECHNICAL DEPENDENCIES\n\n```mermaid\ngraph TD\n    A[Authentication] --> B[Patient Management]\n    B --> C[Scheduling]\n    C --> D[Session Recording]\n    D --> E[AI Scribe Agent]\n    E --> F[Clinical Notes]\n    F --> G[Billing]\n    \n    H[WhatsApp API] --> I[Growth Agent]\n    H --> J[Appointment Reminders]\n    \n    K[Google Health Connect] --> L[BioSync Agent]\n    L --> M[Pre-Session Brief]\n    \n    N[ABDM API] --> O[ABHA ID Creation]\n    O --> P[Consent Management]\n    \n    Q[Agent Orchestrator] --> E\n    Q --> L\n    Q --> I\n```\n\n---\n\n## ACCEPTANCE CRITERIA SUMMARY\n\nEach user story includes:\n- **Persona**: Who benefits from this feature\n- **Action**: What the user wants to do\n- **Benefit**: Why this feature matters\n- **Acceptance Criteria**: Specific, testable requirements\n- **Phase**: MVP, BioSync, or ABDM\n- **Priority**: High, Medium, or Low\n\n---\n\n## NOTES FOR DEVELOPMENT TEAM\n\n1. **Supabase Setup**: Create project in Mumbai region for data residency compliance\n2. **OpenAI BAA**: Apply for Business Associate Agreement for HIPAA compliance\n3. **WhatsApp API**: Use 360Dialog or Twilio as Business Solution Provider\n4. **Payment Gateway**: Razorpay recommended for UPI + subscription support\n5. **Deployment**: Netlify for frontend (auto-deploy from Git), Supabase for backend\n6. **Testing**: Write integration tests for all Edge Functions, E2E tests for critical user flows\n7. **Documentation**: Maintain API docs (Swagger), user guides (Notion), and developer onboarding (README)\n\n---\n\n## GLOSSARY\n\n- **ABHA**: Ayushman Bharat Health Account (India's national health ID)\n- **ABDM**: Ayushman Bharat Digital Mission (India's digital health ecosystem)\n- **BAA**: Business Associate Agreement (required for HIPAA compliance)\n- **EAP**: Employee Assistance Program (corporate wellness benefit)\n- **HIECM**: Health Information Exchange Consent Manager\n- **HITL**: Human-in-the-Loop (AI requires human approval)\n- **HRV**: Heart Rate Variability (wearable metric)\n- **PHI**: Protected Health Information\n- **RAG**: Retrieval-Augmented Generation (AI technique)\n- **RLS**: Row-Level Security (Supabase feature)\n- **SOAP**: Subjective, Objective, Assessment, Plan (clinical note format)\n- **UPI**: Unified Payments Interface (India's instant payment system)\n\n---\n\n**Document Version:** 1.0  \n**Last Updated:** January 2026  \n**Total User Stories:** 60 (30 Backend + 30 Frontend)", "priority": 3}]
